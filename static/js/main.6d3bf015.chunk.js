(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{27:function(e){e.exports={"NCS S 0500 - N (\u0431\u0435\u043b\u044b\u0439)":{code:"NCS S 0500 - N (\u0431\u0435\u043b\u044b\u0439)",rgb:"250,250,250"},"NCS S 1030-B10G (\u0441\u0432. \u0433\u043e\u043b.)":{code:"NCS S 1030-B10G (\u0441\u0432. \u0433\u043e\u043b.)",rgb:"157,223,233"},"NCS S 2002-B50G (\u0441\u0432. \u0441\u0435\u0440.)":{code:"NCS S 2002-B50G (\u0441\u0432. \u0441\u0435\u0440.)",rgb:"182,191,189"},"NCS S 2060-G70Y (\u043e\u043b\u0438\u0432.)":{code:"NCS S 2060-G70Y (\u043e\u043b\u0438\u0432.)",rgb:"174,180,0"},"NCS S 1080-Y (\u0437\u043e\u043b\u043e\u0442.)":{code:"NCS S 1080-Y (\u0437\u043e\u043b\u043e\u0442.)",rgb:"236,188,0"},"NCS S 5040-B70G (\u0438\u0437\u0443\u043c\u0440.)":{code:"NCS S 5040-B70G (\u0438\u0437\u0443\u043c\u0440.)",rgb:"0,83,65"},"NCS S 8010-Y90R (\u0442. \u041a\u043e\u0440.)":{code:"NCS S 8010-Y90R (\u0442. \u041a\u043e\u0440.)",rgb:"41,18,20"},"NCS S 2070-Y90R":{code:"NCS S 2070-Y90R",rgb:"181,31,39"},"NCS S 4050-G10Y":{code:"NCS S 4050-G10Y",rgb:"0,100,53"},"RAL 3001":{code:"RAL 3001",rgb:"152,35,35"},"RAL 6018":{code:"RAL 6018",rgb:"89,154,57"},"NCS S 0575-G90Y":{code:"NCS S 0575-G90Y",rgb:"250,222,0"},"NCS S 1080-Y20R":{code:"NCS S 1080-Y20R",rgb:"244,153,0"},"NCS S 1002-B50G":{code:"NCS S 1002-B50G",rgb:"231,235,230"},"NCS S 5502-B":{code:"NCS S 5502-B",rgb:"91,95,97"},"NCS S 1040-R90B":{code:"NCS S 1040-R90B",rgb:"136,195,226"},"NCS S 1080-Y50R":{code:"NCS S 1080-Y50R",rgb:"235,97,0"},"NCS S 1060-G70Y":{code:"NCS S 1060-G70Y",rgb:"207,212,45"},"NCS S 1075-G60Y":{code:"NCS S 1075-G60Y",rgb:"194,213,0"},"NCS S 2070-G30Y RAL 6038":{code:"NCS S 2070-G30Y RAL 6038",rgb:"62,164,0"},"NCS S 0585-Y70R":{code:"NCS S 0585-Y70R",rgb:"224,47,7"},"NCS S 2070-Y70R":{code:"NCS S 2070-Y70R",rgb:"205,42,3"},"NCS S 1502-B50G":{code:"NCS S 1502-B50G",rgb:"203,211,208"},"RAL 6024":{code:"RAL 6024",rgb:"0,132,80"},"NCS S 7010-Y30R":{code:"NCS S 7010-Y30R",rgb:"66,51,34"},"RAL 7011 NCS S 7502-B":{code:"RAL 7011 NCS S 7502-B",rgb:"41,45,47"},"NCS S 7005-Y80R":{code:"NCS S 7005-Y80R",rgb:"57,50,47"},"NCS S 2030-R10B":{code:"NCS S 2030-R10B",rgb:"215,137,150"},"NCS S 2060-R10B":{code:"NCS S 2060-R10B",rgb:"184,39,80"},"NCS S 3502-B":{code:"NCS S 3502-B",rgb:"141,145,148"},"NCS S 0560-Y60R":{code:"NCS S 0560-Y60R",rgb:"247,127,68"},"NCS S 6502-B":{code:"NCS S 6502-B",rgb:"67,71,73"},"NCS S 0570-G80Y":{code:"NCS S 0570-G80Y",rgb:"243,226,40"},"NCS S 1075-G80Y":{code:"NCS S 1075-G80Y",rgb:"215,214,0"},"NCS S 1080-Y70R":{code:"NCS S 1080-Y70R",rgb:"226,52,3"},"NCS S 1070-G40Y":{code:"NCS S 1070-G40Y",rgb:"159,206,18"},"NCS S 0520-B10G":{code:"NCS S 0520-B10G",rgb:"211,242,247"},"NCS S 3030-B10G":{code:"NCS S 3030-B10G",rgb:"100,174,186"},"NCS S 4030-B10G":{code:"NCS S 4030-B10G",rgb:"59,114,126"},"NCS S 0540-G60Y":{code:"NCS S 0540-G60Y",rgb:"235,241,135"},"NCS S 0540-G30Y":{code:"NCS S 0540-G30Y",rgb:"208,239,159"},"NCS S 0560-G30Y":{code:"NCS S 0560-G30Y",rgb:"176,222,106"},"NCS S 1060-Y20R":{code:"NCS S 1060-Y20R",rgb:"248,167,34"},"NCS S 7020-R10B":{code:"NCS S 7020-R10B",rgb:"36,8,14"},"NCS S 4030-Y50R":{code:"NCS S 4030-Y50R",rgb:"177,120,96"},"NCS S 3030-Y40R":{code:"NCS S 3030-Y40R",rgb:"202,135,81"},"NCS S 6020-R10B":{code:"NCS S 6020-R10B",rgb:"92,47,59"},"NCS S 2010-Y60R":{code:"NCS S 2010-Y60R",rgb:"209,176,148"},"NCS S 3010-Y60R":{code:"NCS S 3010-Y60R",rgb:"181,150,132"},"NCS S 5010-Y50R":{code:"NCS S 5010-Y50R",rgb:"116,94,75"},"NCS S 4550-Y70R":{code:"NCS S 4550-Y70R",rgb:"129,34,15"},"NCS S 0907-Y10R":{code:"NCS S 0907-Y10R",rgb:"249,238,203"},"NCS S 2030-Y40R (NCS S 3030-Y40R+20%)":{code:"NCS S 2030-Y40R (NCS S 3030-Y40R+20%)",rgb:"220,152,95"},"NCS S 2020-Y40R (NCS S 3030-Y40R+30%)":{code:"NCS S 2020-Y40R (NCS S 3030-Y40R+30%)",rgb:"213,165,118"},"RAL 7016 - Anthracite grey":{code:"RAL 7016 - Anthracite grey",rgb:"56,62,66"}}},40:function(e,t,r){e.exports=r.p+"static/media/import.1badb99d.svg"},41:function(e,t,r){e.exports=r.p+"static/media/export.301c5552.svg"},44:function(e,t,r){e.exports=r(75)},51:function(e,t,r){},60:function(e,t,r){},65:function(e,t,r){},67:function(e,t,r){},69:function(e,t,r){},71:function(e,t,r){},75:function(e,t,r){"use strict";r.r(t);var o={};r.r(o),r.d(o,"addBrick",function(){return C}),r.d(o,"removeBrick",function(){return y}),r.d(o,"resetBricks",function(){return k}),r.d(o,"changeBrickSize",function(){return j}),r.d(o,"changeBrickColor",function(){return N}),r.d(o,"resetBrickColors",function(){return w}),r.d(o,"changeTemplateSize",function(){return E}),r.d(o,"setSectorSize",function(){return P}),r.d(o,"changePresetName",function(){return R}),r.d(o,"setColor",function(){return T}),r.d(o,"changeCurrentPreset",function(){return B}),r.d(o,"historyPush",function(){return x}),r.d(o,"historySwap",function(){return L}),r.d(o,"historyRemove",function(){return z}),r.d(o,"addColorPalette",function(){return Y}),r.d(o,"removeColorPalette",function(){return _}),r.d(o,"addColorToPalette",function(){return A}),r.d(o,"removeColorFromPalette",function(){return G}),r.d(o,"switchPalette",function(){return I}),r.d(o,"switchTextureType",function(){return D}),r.d(o,"addRandomPalette",function(){return M}),r.d(o,"setRandomPalettes",function(){return K}),r.d(o,"removeRandomPalette",function(){return V});var n=r(8),a=r.n(n),i=r(16),c=r(3),s=r(1),l=r.n(s),u=r(17),p=r.n(u),d=(r(51),r(18)),h=r(14),b=r.n(h);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var m=r(7),f=r(4),g=r(76),S=r(6),v=r.n(S),O=r(77),C=Object(O.a)("ADD_BRICK"),y=Object(O.a)("REMOVE_BRICK"),k=Object(O.a)("RESET_BRICKS"),j=Object(O.a)("CHANGE_BRICK_SIZE"),N=Object(O.a)("CHANGE_BRICK_COLOR"),w=Object(O.a)("RESET_BRICK_COLOR"),E=Object(O.a)("CHANGE_TEMPLATE_SIZE"),P=Object(O.a)("SET_SECTOR_SIZE"),R=Object(O.a)("CHANGE_PRESET_NAME"),T=Object(O.a)("SET_COLOR"),B=Object(O.a)("CHANGE_CURRENT_PRESET"),x=Object(O.a)("HISTORY_PUSH"),L=Object(O.a)("HISTORY_SWAP"),z=Object(O.a)("HISTORY_REMOVE"),Y=Object(O.a)("ADD_COLOR_PALETTE"),_=Object(O.a)("REMOVE_COLOR_PALETTE"),A=Object(O.a)("ADD_COLOR_TO_PALETTE"),G=Object(O.a)("REMOVE_COLOR_TO_PALETTE"),I=Object(O.a)("SWITCH_PALETTE"),D=Object(O.a)("SWITCH_TEXTURE_TYPE"),M=Object(O.a)("ADD_RANDOM_PALETTE"),K=Object(O.a)("SET_RANDOM_PALETTE"),V=Object(O.a)("REMOVE_RANDOM_PALETTE");var H=function(e){var t;return console.log("INIT PALETTE",e),Object(g.a)((t={},Object(c.a)(t,Y,function(e){var t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"new";return{id:b()(),name:e,colors:[]}}("\u043f\u0430\u043b\u0438\u0442\u0440\u0430 ".concat(Object.keys(e.palettes).length));return Object(f.a)({},e,{currentPalette:t.id,palettes:Object(f.a)({},e.palettes,Object(c.a)({},t.id,t))})}),Object(c.a)(t,I,function(e,t){return Object(f.a)({},e,{currentPalette:t.payload})}),Object(c.a)(t,G,function(e,t){return Object(f.a)({},e,{palettes:Object(f.a)({},e.palettes,Object(c.a)({},e.currentPalette,Object(f.a)({},e.palettes[e.currentPalette],{colors:e.palettes[e.currentPalette].colors.filter(function(e){return e.code!==t.payload})})))})}),Object(c.a)(t,A,function(e,t){var r=e.palettes[e.currentPalette];return Object(f.a)({},e,{palettes:Object(f.a)({},e.palettes,Object(c.a)({},e.currentPalette,Object(f.a)({},r,{colors:r.colors.concat([t.payload])})))})}),t),e)},F=r(43),U=r(26),X=r.n(U),J="ADD_BRICK",q="REMOVE_BRICK",W="CHANGE_COLOR_BRICK",Z=function(e,t,r){return{left:Math.floor(e/r),top:Math.floor(t/r)}},$=function(e,t){return Object.keys(e).reduce(function(r,o){return Object(f.a)({},r,Object(c.a)({},o,e[o]*t))},{})};function Q(e){var t={};return Object.values(e).forEach(function(e){for(var r=0;r<e.size.width;r+=1)for(var o=0;o<e.size.height;o+=1)t["".concat(r+e.position.left,";").concat(o+e.position.top)]=e}),t}function ee(e,t){var r=t.width,o=t.height;return 1===r&&1===o?e:r>o?{top:e.top,left:e.left-Math.round(r/2)}:{left:e.left,top:e.top-Math.round(o/2)}}var te=function(e){return e?"rgb(".concat(e,")"):"rgb(214,199,148)"};function re(e,t){for(var r=Q(e),o={},n=0;n<t.width;n+=1)for(var a=0;a<t.height;a+=1){var i=r["".concat(n+t.left,";").concat(a+t.top)];i&&!o[i.id]&&(o[i.id]=i)}var c=Object.values(o),s=Object.values(c).map(function(e){var r=e.position,o=r.left-t.left,n=r.top-t.top;return Object(f.a)({},e,{position:{left:o,top:n}})});return c.length>0?s:[]}function oe(e,t){return ne.apply(this,arguments)}function ne(){return(ne=Object(i.a)(a.a.mark(function e(t,r){var o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X.a.toPng(document.querySelector(".sectorItem"),{width:15*t,height:15*r});case 2:return o=e.sent,e.abrupt("return",o);case 4:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function ae(e,t,r){var o=e.left-r.left,n=e.top-r.top;return[o<0||n<0,o+t.width>r.width,n+t.height>r.height].some(function(e){return e})}var ie=function(e,t){var r=e.position,o=e.size,n=r.left>0?-t.width:t.width,a=r.top>0?-t.height:t.height;if(o.width>o.height){var i={left:r.left+n+t.left,top:r.top+t.top};return{id:b()(),position:i,size:o}}var c={left:r.left+t.left,top:r.top+a+t.top};return{id:b()(),position:c,size:o}},ce=function(e,t){return e.width>e.height?e.width>t.width:e.height>t.height};function se(e,t){var r=Object.values(t),o=r.map(function(e){return e.value}).reduce(function(e,t){return e+t}),n=r.map(function(e){return e.value/o}).map(function(t){return Math.round(e.length*t)}),a={};return Object.values(e).forEach(function(e){var t=function(){for(var e=0;e<100;){e+=1;var t=Math.floor(Math.random()*n.length);if(0===n.reduce(function(e,t){return e+t}))return r[t].color;if(n[t]>0)return n[t]-=1,r[t].color}throw new Error("coloring iterations exceeded")}();e.forEach(function(e){a[e.id]=t})}),a}function le(e,t,r,o){return e.type===J&&(r===t.width&&o===t.height)}var ue,pe,de,he,be=function(e){var t=e.reduce(function(t,r,o){var n=r.value,a=r.color.rgb,i=function(e,t){var r=e.map(function(e){return e.value}).reduce(function(e,t){return e+t});return 0===t?0:Math.round(t/r*100)}(e,n),c=te(a);if(0===o)return[{color:c,percent:0},{color:c,percent:i}];var s=t[t.length-1].percent,l=s+i;return Object(m.a)(t).concat([{color:c,percent:s},{color:c,percent:l}])},[]);return"linear-gradient(to right, ".concat(t.map(function(e){var t=e.color,r=e.percent;return"".concat(t," ").concat(r,"%")}).join(", "),")")},me=function(e,t,r){var o=e.toString(16),n=t.toString(16),a=r.toString(16);return 1===e.length&&(o="0".concat(e)),1===t.length&&(n="0".concat(t)),1===r.length&&(a="0".concat(r)),(o+n+a).toUpperCase()},fe=function(e,t,r){if(e.size.width>e.size.height){var o=e.position.left<r.left?r.width:-r.width;return Object.values(t).find(function(t){return t.position.left===e.position.left+o&&t.position.top===e.position.top})}var n=e.position.top<r.top?r.height:-r.height;return Object.values(t).find(function(t){return t.position.top===e.position.top+n&&t.position.left===e.position.left})},ge=Object(g.a)((ue={},Object(c.a)(ue,C,function(e,t){var r=t.payload.brick;return Object(f.a)({},e,Object(c.a)({},r.id,r))}),Object(c.a)(ue,y,function(e,t){var r=t.payload.brick;return v.a.omit(e,r.id)}),Object(c.a)(ue,k,function(){return{}}),ue),{}),Se=Object(g.a)(Object(c.a)({},j,function(e,t){return t.payload.size}),{width:1,height:1}),ve=Object(g.a)(Object(c.a)({},E,function(e,t){var r=t.payload.newSize;return Object(f.a)({},e,r)}),{width:10,height:10}),Oe=Object(g.a)(Object(c.a)({},P,function(e,t){var r=t.payload;return Object(f.a)({},e,r)}),{left:3,top:3,width:4,height:4}),Ce=Object(g.a)((pe={},Object(c.a)(pe,C,function(e,t){var r=t.payload,o=r.brick.id,n=r.color,a=r.colorPresetName,i="".concat(o,"-").concat(a);return Object(f.a)({},e,Object(c.a)({},i,{colorPresetName:a,brickId:o,color:n}))}),Object(c.a)(pe,N,function(e,t){var r=t.payload,o=r.brickId,n=r.color,a=r.colorPresetName,i="".concat(o,"-").concat(a);return Object(f.a)({},e,Object(c.a)({},i,{colorPresetName:a,brickId:o,color:n}))}),Object(c.a)(pe,w,function(e){return v.a.mapValues(e,function(e){return Object(f.a)({},e,{color:{code:"NCS S 0500 - N (\u0431\u0435\u043b\u044b\u0439)",rgb:"250,250,250"}})})}),Object(c.a)(pe,y,function(e,t){var r=t.payload.brick;return v.a.omitBy(e,function(e){return e.brickId===r.id})}),Object(c.a)(pe,R,function(e){return e}),pe),{}),ye=Object(g.a)((de={},Object(c.a)(de,x,function(e,t){var r=t.payload.operations;return{undo:Object(m.a)(e.undo).concat([r]),redo:[]}}),Object(c.a)(de,L,function(e,t){var r=t.payload.type,o=e.undo,n=e.redo;return"undo"===r?{undo:o.slice(0,o.length-1),redo:Object(m.a)(n).concat([v.a.last(o)])}:{undo:Object(m.a)(o).concat([v.a.last(n)]),redo:n.slice(0,n.length-1)}}),Object(c.a)(de,z,function(){return{undo:[],redo:[]}}),de),{undo:[],redo:[]}),ke=Object(g.a)(Object(c.a)({},R,function(e,t){return t.payload.name}),"1"),je=Object(g.a)(Object(c.a)({},D,function(e){return"brick"===e?"tile":"brick"}),"brick"),Ne=Object(g.a)((he={},Object(c.a)(he,M,function(e,t){var r=t.payload,o=r.map(function(e){var t=e.color.rgb;return{value:e.value,color:me.apply(void 0,Object(m.a)(t.split(",")))}}).sort(function(e,t){return e.color>t.color?1:e.color<t.color?-1:0}).reduce(function(e,t){var r=t.color,o=t.value;return"".concat(e).concat(r).concat(o)},"");return Object(f.a)({},e,Object(c.a)({},o,r))}),Object(c.a)(he,K,function(e,t){var r=t.payload;return Object(f.a)({},r)}),Object(c.a)(he,V,function(e,t){var r=t.payload;return v.a.omit(e,r)}),he),{}),we=function(e){var t=e.colorPaletteState;return Object(d.b)({bricks:ge,templateSize:ve,brickSize:Se,sector:Oe,bricksColors:Ce,history:ye,colorPresetName:ke,textureType:je,randomPaletts:Ne,colorPalette:H(t)})},Ee=r(21),Pe=(r(60),r(9)),Re=r(10),Te=r(12),Be=r(11),xe=r(13),Le=r(5),ze=r(42),Ye=r(30),_e=r.n(Ye),Ae=r(31),Ge=r(2),Ie=r.n(Ge),De=l.a.memo(function(e){var t=e.style,r=e.color,o=e.onClick,n=e.button,a=e.active,i=e.textureType,c=te(r);return l.a.createElement("div",{onClick:o,className:Ie()("brick",{button:n,active:a}),style:Object(f.a)({},t,{backgroundColor:c,borderColor:"brick"===i?"rgb(0,0,0)":"rgb(1,1,1)"})})});function Me(e){switch(e.type){case"CHANGE_COLOR_BRICK":return"crosshair";case"REMOVE_BRICK":case"ADD_BRICK":default:return"default"}}var Ke={display:"grid",gridTemplateColumns:"26px auto",gridTemplateRows:"26px auto",justifyItems:"left",alignItems:"left",gridTemplateAreas:'"top-tool top-tool" "left-tool editor"'},Ve={gridArea:"top-tool",display:"block",width:"100%",height:"100%"},He=function(e){function t(e){var r;return Object(Pe.a)(this,t),(r=Object(Te.a)(this,Object(Be.a)(t).call(this,e))).cursorPosition=function(){var e=r.props,t=e.position,o=t.x,n=t.y,a=e.step,i=Z(o-26,n-26,a);r.setState({cursorPosition:i})},r.keyBoardEvents=function(e){console.log(e.key)},r.addBrick=function(){for(var e={id:b()(),position:ee(r.state.cursorPosition,r.props.brickSize),size:r.props.brickSize},t=r.props,o=t.bricks,n=t.colorPresetName,a=t.color,i=Q(o),c=[],s=0;s<e.size.width;s+=1)for(var l=0;l<e.size.height;l+=1)if(i["".concat(s+e.position.left,";").concat(l+e.position.top)])return;if(ae(e.position,e.size,r.props.sector)){var u=re([e],r.props.sector)[0];if(u){if(ce(u.size,r.props.sector))return;for(var p=ie(u,r.props.sector),d=0;d<p.size.width;d+=1)for(var h=0;h<p.size.height;h+=1)if(i["".concat(d+p.position.left,";").concat(h+p.position.top)])return;r.props.addBrick({brick:p,color:a,colorPresetName:n}),c.push({type:J,data:{brick:p,color:a,colorPresetName:n}})}}r.props.addBrick({brick:e,color:a,colorPresetName:n});var m={type:r.props.currentOperation.type,data:{brick:e,color:a,colorPresetName:n}},f=c.length>0?c.concat([m]):m;r.props.historyPush({operations:f})},r.removeBrick=function(e){var t=r.props,o=t.colorPresetName,n=t.color;if(e){r.props.removeBrick({brick:e});var a={type:r.props.currentOperation.type,data:{brick:e,color:n,colorPresetName:o}};r.props.historyPush({operations:a})}},r.changeBrickColor=function(e){if(e){var t=r.props,o=t.color,n=t.colorPresetName,a=t.bricksColors,i=a["".concat(e.id,"-").concat(n)]?a["".concat(e.id,"-").concat(n)].color:void 0,c=[];if(ae(e.position,e.size,r.props.sector))if(re([e],r.props.sector)[0]){var s=fe(e,r.props.bricks,r.props.sector);s&&(r.props.changeBrickColor({brickId:s.id,color:o,colorPresetName:n}),c.push({type:r.props.currentOperation.type,data:{brickId:s.id,color:{old:i,new:o},colorPresetName:n}}))}r.props.changeBrickColor({brickId:e.id,color:o,colorPresetName:n}),c.push({type:r.props.currentOperation.type,data:{brickId:e.id,color:{old:i,new:o},colorPresetName:n}}),r.props.historyPush({operations:c})}},r.handleOperation=function(e){return function(t){t.stopPropagation();var o=r.props.currentOperation.type;if(o){var n,a=(n={},Object(c.a)(n,J,r.addBrick),Object(c.a)(n,q,r.removeBrick),Object(c.a)(n,W,r.props.disablePaintButton?null:r.changeBrickColor),n);if(!a[o])return;a[o](e)}}},r.state={cursorPosition:{left:0,top:0}},r}return Object(xe.a)(t,e),Object(Re.a)(t,[{key:"renderSector",value:function(){var e=this.props,t=e.step,r=e.sector,o={left:0,top:0,width:r.width*t,height:2},n={left:0,top:r.height*t,width:r.width*t,height:2},a={left:0,top:0,width:2,height:r.height*t},i={left:r.width*t,top:0,width:2,height:r.height*t+2};return l.a.createElement("div",{className:"templateSector",style:Object(f.a)({},$(r,this.props.step),{width:0,height:0})},l.a.createElement("div",{className:"sectorLine",style:o}),l.a.createElement("div",{className:"sectorLine",style:n}),l.a.createElement("div",{className:"sectorLine",style:a}),l.a.createElement("div",{className:"sectorLine",style:i}))}},{key:"renderBrickPreview",value:function(e){var t=ee(e,this.props.brickSize),r=$(Object(f.a)({},this.props.brickSize,t),this.props.step);return l.a.createElement(De,{style:r,color:this.props.color.rgb,textureType:this.props.textureType})}},{key:"render",value:function(){var e=this,t=this.props,r=t.isActive,o=t.currentOperation,n=t.step,a=t.bricks,i=t.bricksColors,c=t.colorPresetName,s=t.textureType;return l.a.createElement("div",{style:Object(f.a)({},Ke,{marginBottom:"tile"===s?"17px":0})},l.a.createElement("div",{style:Ve},[1,2,3,4].filter(function(e){return"tile"!==s||3===e}).map(function(t){return l.a.createElement(De,{button:!0,active:le(o,e.props.brickSize,t,1),onClick:e.props.setBrickOperation(t,1),key:t,style:{width:20*t,height:20,position:"relative",marginRight:6},textureType:e.props.textureType})}),l.a.createElement("div",{className:Ie()("tool-button","paint-button",{buttonActive:o.type===W}),onClick:this.props.setPaintOperation,style:{backgroundColor:this.props.disablePaintButton?"gray":"rgb(".concat(this.props.color.rgb,")"),display:"inline-block",marginLeft:1,top:-1,position:"relative"}})),l.a.createElement("div",{style:{gridArea:"left-tool",width:20,paddingTop:3}},[2,3,4].filter(function(e){return"tile"!==s||3===e}).map(function(t){return l.a.createElement(De,{button:!0,onClick:e.props.setBrickOperation(1,t),active:le(o,e.props.brickSize,1,t),key:t,"data-w":1,"data-h":t,style:{width:20,height:20*t,position:"relative",marginBottom:7,marginTop:-4},textureType:e.props.textureType})}),l.a.createElement("div",{className:Ie()("tool-button","trash-button",{buttonActive:o.type===q}),onClick:this.props.setRemoveBrickOperation,style:{marginTop:-4}})),l.a.createElement("div",{className:"bricks-grid",onMouseMove:this.cursorPosition,onClick:this.handleOperation(),style:Object(f.a)({},$({height:11,width:11},n),{cursor:this.props.disablePaintButton?"default":Me(o),gridArea:"editor"})},Object.values(a).map(function(t){var r="".concat(t.id,"-").concat(c),o=i[r]?i[r].color.rgb:null;return l.a.createElement(De,{key:t.id,id:t.id,className:"brick",color:o,style:$(Object(f.a)({},t.position,t.size),n),onClick:e.handleOperation(t),textureType:e.props.textureType})}),r&&o.type===J&&this.props.position.x>40&&this.props.position.y>40?this.renderBrickPreview(this.state.cursorPosition):null,this.renderSector()))}}]),t}(s.Component),Fe=Object(Ee.b)(function(e){return{bricks:e.bricks,templateSize:e.templateSize,brickSize:e.brickSize,sector:e.sector,bricksColors:e.bricksColors,colorPresetName:e.colorPresetName,textureType:e.textureType}},o)(He);function Ue(e,t,r){var o=e["".concat(t,"-").concat(r)];return o?o.color.rgb:null}function Xe(e){var t=e.bricks,r=e.sector,o=e.bricksColors,n=e.width,a=e.step,i=e.colorPresetName,c=e.textureType;console.log("Preview Type",c);var s=new Array(1).fill(null).map(function(e,n){return l.a.createElement("div",{key:n,className:"sectorItem",style:Object(f.a)({},$({width:r.width,height:r.height},a))},t.map(function(e){var t=e.position,r=e.size,n=e.id;return l.a.createElement(De,{key:n,className:"brick",color:Ue(o,n,i),style:$(Object(f.a)({},t,r),a),textureType:c})}))});return l.a.createElement("div",{style:{gridTemplateColumns:new Array(1).fill(null).map(function(){return"".concat(a*n,"px")}).join(" ")},className:"grid-area-preview"},s)}r(65);var Je=function(e){function t(){var e,r;Object(Pe.a)(this,t);for(var o=arguments.length,n=new Array(o),a=0;a<o;a++)n[a]=arguments[a];return(r=Object(Te.a)(this,(e=Object(Be.a)(t)).call.apply(e,[this].concat(n)))).state={dropdownOpen:!1},r.toggle=function(){r.setState(function(e){return{dropdownOpen:!e.dropdownOpen}})},r.setColor=function(e){return function(){r.props.setNewColor(e)}},r.removeColor=function(e){return function(t){t.preventDefault(),r.props.removeColor(e)}},r}return Object(xe.a)(t,e),Object(Re.a)(t,[{key:"render",value:function(){var e=this,t=this.props.colorList;return l.a.createElement("div",{className:"color-palette"},Object.values(t).map(function(t){return l.a.createElement("div",{className:"color-palette-item",key:t.code,style:{backgroundColor:te(t.rgb)},onClick:e.setColor(t),title:t.code,onContextMenu:e.removeColor(t.code)})}))}}]),t}(s.Component),qe=function(e){function t(){var e,r;Object(Pe.a)(this,t);for(var o=arguments.length,n=new Array(o),a=0;a<o;a++)n[a]=arguments[a];return(r=Object(Te.a)(this,(e=Object(Be.a)(t)).call.apply(e,[this].concat(n)))).state={colorList:[]},r}return Object(xe.a)(t,e),Object(Re.a)(t,[{key:"changeColor",value:function(e){var t=this.props.colors[e];this.props.changeColor(t);var r=this.state.colorList;if(!r.some(function(t){return t.code===e})){var o=r.length>5?r.slice(1).concat([t]):Object(m.a)(r).concat([t]);this.setState({colorList:o})}}},{key:"render",value:function(){var e=this;return l.a.createElement("div",{className:"color-list"},l.a.createElement("select",{onChange:function(t){return e.changeColor(t.target.value)},style:{backgroundColor:te(this.props.color.rgb),fontSize:"12px",margin:"6px 0 4px"},value:this.props.color.code},Object.values(this.props.colors).map(function(e){var t=e.code,r=e.rgb;return l.a.createElement("option",{style:{backgroundColor:te(r)},key:t,value:t},t)})),l.a.createElement(Je,{color:this.state.currentColor,setNewColor:this.props.changeColor,colorList:this.state.colorList,setColorList:this.setColorList,removeColor:this.removeColor}))}}]),t}(s.Component);r(67);var We=function(e){return l.a.createElement("div",{style:e.style,className:"number-input"},l.a.createElement("div",{className:"ctl",onClick:function(){return function(e){e.onChange&&e.onChange instanceof Function&&(e.value<=e.min||e.onChange(e.value-1))}(e)}},"-"),l.a.createElement("div",{className:"val"},e.value),l.a.createElement("div",{className:"ctl",onClick:function(){return function(e){e.onChange&&e.onChange instanceof Function&&(e.value>=e.max||e.onChange(e.value+1))}(e)}},"+"))},Ze=r(27),$e=function(e,t,r,o){var n=[];return e.forEach(function(e){for(var a=0;a<r;a+=1)for(var i=function(r){var o=e.position.left+a*t.width,i=e.position.top+r*t.height,c={id:b()(),position:{left:o,top:i},size:Object(f.a)({},e.size)};n.some(function(e){var t=e.position;return v.a.isEqual(t,c.position)})||n.push(c)},c=0;c<o;c+=1)i(c)}),n},Qe=r(20),et=function(e){function t(e){var r;return Object(Pe.a)(this,t),(r=Object(Te.a)(this,Object(Be.a)(t).call(this,e))).handleSector=function(e,t){var o=Object(c.a)({},e,Number(t));r.props.confirmChangeSectorSize()&&r.props.setSectorSize(o)},r.toggle=r.toggle.bind(Object(Le.a)(Object(Le.a)(r))),r.state={popoverOpen:!1},r}return Object(xe.a)(t,e),Object(Re.a)(t,[{key:"toggle",value:function(){var e=this.state.popoverOpen;this.setState({popoverOpen:!e})}},{key:"render",value:function(){var e=this;return l.a.createElement("div",null,l.a.createElement("div",{className:"grid-sector-options-panel"},l.a.createElement("span",{style:{float:"left",fontSize:12,marginLeft:12,position:"relative",top:6}},"\u0420\u0430\u0437\u043c\u0435\u0440 \u0442\u0435\u043a\u0441\u0442\u0443\u0440\u044b"),l.a.createElement(We,{style:{position:"relative",top:4},value:this.props.sector.width,min:2,max:11,onChange:function(t){return e.handleSector("width",t)}}),l.a.createElement(We,{style:{position:"relative",top:4},value:this.props.sector.height,min:2,max:11,onChange:function(t){return e.handleSector("height",t)}})),l.a.createElement("div",{className:"tool-button",style:{backgroundColor:"gray",textAlign:"center",width:24,height:24,borderRadius:100,position:"relative",top:4},id:"Popover1",onClick:this.toggle,color:"link"},"?"),l.a.createElement(Qe.b,{placement:"bottom",isOpen:this.state.popoverOpen,target:"Popover1",toggle:this.toggle},l.a.createElement(Qe.d,null,"\u041f\u043e\u043c\u043e\u0449\u044c"),l.a.createElement(Qe.c,null,l.a.createElement("div",null,"\u0414\u043b\u044f \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0446\u0432\u0435\u0442\u0430 \u0432 \u043f\u0430\u043b\u0438\u0442\u0440\u0443 \u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0435\u0433\u043e \u0438\u0437 \u0432\u044b\u043f\u0430\u0434\u0430\u044e\u0449\u0435\u0433\u043e \u0441\u043f\u0438\u0441\u043a\u0430. \u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0438\u0437 \u043f\u0430\u043b\u0438\u0442\u0440\u044b \u043f\u0440\u0430\u0432\u043e\u0439 \u043a\u043b\u0430\u0432\u0438\u0448\u0435\u0439 \u043c\u044b\u0448\u0438.",l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement("b",null,'\u0437\u0430\u0436\u0430\u0442\u044b\u0439 "alt" - \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0446\u0432\u0435\u0442 \u043a\u0438\u0440\u043f\u0438\u0447\u0430')),l.a.createElement("li",null,l.a.createElement("b",null,'\u0437\u0430\u0436\u0430\u0442\u044b\u0439 "shift" - \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043a\u0438\u0440\u043f\u0438\u0447')),l.a.createElement("li",null,l.a.createElement("b",null,'"ctrl+z" - \u043e\u0442\u043c\u0435\u043d\u0438\u0442\u044c \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435')),l.a.createElement("li",null,l.a.createElement("b",null,'"ctrl+y" - \u0432\u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435')),l.a.createElement("li",null,l.a.createElement("b",null,'"up, down, left, right" - \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u0441\u0435\u043a\u0442\u043e\u0440\u0430')),l.a.createElement("li",null,l.a.createElement("b",null,'"+" - \u0443\u0432\u0435\u043b\u0438\u0447\u0438\u0442\u044c \u0440\u0430\u0437\u043c\u0435\u0440 \u0441\u0435\u043a\u0442\u043e\u0440\u0430')),l.a.createElement("li",null,l.a.createElement("b",null,'"-" - \u0443\u043c\u0435\u043d\u044c\u0448\u0438\u0442\u044c \u0440\u0430\u0437\u043c\u0435\u0440 \u0441\u0435\u043a\u0442\u043e\u0440\u0430')))))))}}]),t}(l.a.Component),tt=(r(69),r(40)),rt=r.n(tt),ot=r(41),nt=r.n(ot),at=(r(71),function(e){function t(e){var r;return Object(Pe.a)(this,t),(r=Object(Te.a)(this,Object(Be.a)(t).call(this,e))).state={colorList:[],historyColorList:[],palettesVisible:!1},r.addNewColor=function(){var e=r.props.color,t=r.state.colorList;r.setState({colorList:Object(m.a)(t).concat([{color:e,value:1}])})},r.handleHisoryListClick=function(e){return function(){r.setState({colorList:Object(m.a)(e),palettesVisible:!1})}},r.handlePreviewListClick=function(e){return function(){var t=r.state.historyColorList,o=5===t.length?Object(m.a)(t.slice(1,5)).concat([e]):Object(m.a)(t).concat([e]);r.setState({colorList:Object(m.a)(e),historyColorList:o})}},r.handlePalettesVisible=function(){r.setState({palettesVisible:!r.state.palettesVisible})},r.onClickRandomPalett=function(e){var t=r.state.historyColorList;r.setState({historyColorList:Object(m.a)(t).concat([e])})},r.changeColorValue=r.changeColorValue.bind(Object(Le.a)(Object(Le.a)(r))),r.changeColor=r.changeColor.bind(Object(Le.a)(Object(Le.a)(r))),r}return Object(xe.a)(t,e),Object(Re.a)(t,[{key:"changeColorValue",value:function(e,t){var r=this.state.colorList[e];this.setState(function(o){var n=o.colorList.slice(0);return n.splice(e,1,Object(f.a)({},r,{value:t})),{colorList:n}})}},{key:"changeColor",value:function(e,t){var r=this,o=this.state.colorList[e];this.setState(function(n){var a=n.colorList.slice(0);return a.splice(e,1,{color:r.props.colors[t],value:o.value}),{colorList:a}})}},{key:"deleteColor",value:function(e){this.setState(function(t){var r=t.colorList.slice(0);return r.splice(e,1),{colorList:r}})}},{key:"renderColorList",value:function(){var e=this,t=this.state.colorList,r=t.map(function(e){return e.value}).reduce(function(e,t){return e+t});return l.a.createElement(l.a.Fragment,null,t.map(function(t,o){return l.a.createElement("div",{key:o,className:"color-preview"},l.a.createElement("div",{className:"delete-random-color",onClick:function(){return e.deleteColor(o)}}),l.a.createElement("select",{onChange:function(t){return e.changeColor(o,t.target.value)},style:{backgroundColor:te(t.color.rgb)}},Object.values(e.props.colors).map(function(e){return l.a.createElement("option",{value:e.code,key:e.code,style:{backgroundColor:te(e.rgb)}},e.code)})),l.a.createElement("input",{type:"number",value:t.value,min:"0",onChange:function(t){return e.changeColorValue(o,Number(t.target.value))}}),l.a.createElement("span",{className:"percent"},0===(n=t.value)?0:Math.round(n/r*100),"%"));var n}))}},{key:"renderPreviewHistory",value:function(){var e=this;return l.a.createElement("div",{className:"preview-history-wrapper"},l.a.createElement("div",{className:"preview-history"},0===this.state.historyColorList.length?null:this.state.historyColorList.map(function(t,r){return l.a.createElement("div",{onClick:e.handleHisoryListClick(t),key:r,className:"preview-history-item"},l.a.createElement("div",{style:{background:be(t),backgroundSize:"contain",width:"100%",height:"100%"}}))}),l.a.createElement("div",{className:"button-open-palette-list"},l.a.createElement("div",{onClick:this.handlePalettesVisible}))))}},{key:"renderRandomPalette",value:function(){var e=this;return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{onClick:function(){return e.setState({palettesVisible:!1})},className:"preview-list"},0===Object.keys(this.props.randomPalettes).length?null:Object.keys(this.props.randomPalettes).map(function(t,r){return console.log(e.props.randomPalettes[t]),l.a.createElement("div",{className:"preview-list-item",key:r},l.a.createElement("div",{className:"img",style:{background:be(e.props.randomPalettes[t])},onClick:e.handlePreviewListClick(e.props.randomPalettes[t])}),l.a.createElement("div",{className:"tool-button trash-button",style:{width:"34px",height:"34px",margin:"1px 0 0 5px"},onClick:e.props.removeRandomPalette(t)}))})))}},{key:"render",value:function(){var e=this;return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"texture-panel-container"},this.renderPreviewHistory(),this.state.palettesVisible?this.renderRandomPalette():null),l.a.createElement("div",{style:{textAlign:"right",userSelect:"none"}},l.a.createElement("span",{style:{float:"left",fontSize:12,marginLeft:12}},"\u0421\u043b\u0443\u0447\u0430\u0439\u043d\u0430\u044f \u043f\u043e\u043a\u0440\u0430\u0441\u043a\u0430"),l.a.createElement("div",{className:"tool-button",style:{marginLeft:6,backgroundImage:"url(".concat(rt.a,")")},size:"sm"},window.vasya?l.a.createElement("div",{className:"custom-file-input",onClick:this.props.importPaintingPalettes}):l.a.createElement("input",{type:"file",className:"custom-file-input",required:!0,onChange:this.props.importPaintingPalettes})),l.a.createElement("div",{className:"tool-button",style:{marginLeft:6,backgroundImage:"url(".concat(nt.a,")")},onClick:this.props.exportPaintingPalettes,size:"sm"}),l.a.createElement("div",{className:"tool-button random-button",style:{marginLeft:6,color:"transparent",backgroundColor:this.props.defaultPainting?"gray":"transparent"},onClick:function(){return e.props.makeRandomPainting(e.state.colorList)},size:"sm"},"i"),l.a.createElement("div",{className:"tool-button",style:{textAlign:"center"},onClick:this.addNewColor,size:"sm"},"+")),l.a.createElement("div",{style:{height:"87px",overflowY:"auto",position:"relative",marginBottom:"5px"}},this.state.colorList.length>0?this.renderColorList():null,l.a.createElement(Qe.a,{style:{backgroundColor:"lightgray",color:"black"},onClick:this.props.onSaveRandomPalette(this.state.colorList),size:"sm",block:!0},"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u043f\u0430\u043b\u0438\u0442\u0440\u0443")),l.a.createElement(Qe.a,{onClick:this.props.onSave,size:"sm",block:!0},"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"))}}]),t}(s.Component)),it=["left","up","right","down","alt","shift","ctrl+z","ctrl+y","+","-"],ct=new Set(["left","up","right","down","+","-"]),st={minHeight:454,display:"inline-grid",border:"1px solid gray",gridTemplateColumns:"auto auto",gridTemplateRows:"auto",gridColumnGap:"10px",gridRowGap:"15px",placeItems:"flex-start",gridTemplateAreas:'"editor preview"'},lt={padding:"6px 0 6px 6px"},ut=function(e){function t(e){var r;return Object(Pe.a)(this,t),(r=Object(Te.a)(this,Object(Be.a)(t).call(this,e))).setSectorSize=function(e){r.props.setSectorSize(e)},r.confirmChangeSectorSize=function(){return!(Object.keys(r.props.bricks).length>0)||!!confirm("\u041f\u0440\u0438 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0438 \u0440\u0430\u0437\u043c\u0435\u0440\u0430 \u0442\u0435\u043a\u0441\u0442\u0443\u0440\u044b \u0432\u0441\u0435 \u043a\u0438\u0440\u043f\u0438\u0447\u0438 \u0431\u0443\u0434\u0443\u0442 \u0443\u0434\u0430\u043b\u0435\u043d\u044b. \u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u044c?")&&(r.props.resetBricks(),!0)},r.handleKeyDown=function(e){var t=r.props,o=t.sector,n=t.setSectorSize;if(!ct.has(e)||r.confirmChangeSectorSize()){var a={alt:W,shift:q,"ctrl+z":r.undoredo.bind(Object(Le.a)(Object(Le.a)(r)),"undo"),"ctrl+y":r.undoredo.bind(Object(Le.a)(Object(Le.a)(r)),"redo"),left:n.bind(Object(Le.a)(Object(Le.a)(r)),{left:o.left-1}),up:n.bind(Object(Le.a)(Object(Le.a)(r)),{top:o.top-1}),right:n.bind(Object(Le.a)(Object(Le.a)(r)),{left:o.left+1}),down:n.bind(Object(Le.a)(Object(Le.a)(r)),{top:o.top+1}),"+":n.bind(Object(Le.a)(Object(Le.a)(r)),{width:o.width+1,height:o.height+1}),"-":n.bind(Object(Le.a)(Object(Le.a)(r)),{width:o.width-1,height:o.height-1})}[e];v.a.isFunction(a)?a():r.setState({isDisabledHandleKey:!0,operation:{type:a}})}},r.changeColor=function(e){return r.setState({color:e})},r.setBrickOperation=function(e,t){return function(){console.log("set operation ADD_BRICK",e,t),r.props.changeBrickSize({size:{width:e,height:t}}),r.setOperation({type:J})}},r.setPaintOperation=function(){return r.setOperation({type:W})},r.setRemoveBrickOperation=function(){return r.setOperation({type:q})},r.onSaveRandomPalette=function(e){return function(){0!==e.length&&r.props.addRandomPalette(e)}},r.removeRandomPalette=function(e){return function(t){t.stopPropagation(),r.props.removeRandomPalette(e)}},r.importPaintingPalettes=function(e){if(e.preventDefault(),window.vasya){var t=window.vasya.loadPalette();if(t){var o=JSON.parse(t);r.props.setRandomPalettes(o)}}else{var n=e.target.files;if(0===n.length)return;var a=n[0],i=new FileReader;i.onloadend=function(){var e=Ae.Base64.decode(i.result);if(0!==e.length){var t=JSON.parse(e);r.props.setRandomPalettes(t)}},i.readAsText(a)}},r.exportPaintingPalettes=function(){if(0!==Object.keys(r.props.randomPalettes).length){var e=JSON.stringify(r.props.randomPalettes);if(window.vasya)window.vasya.savePalette(e);else{var t=new Blob([Ae.Base64.encode(e)],{type:"application/json"}),o=window.URL.createObjectURL(t),n=document.createElement("a");n.href=o,n.setAttribute("download","template.txt"),n.click()}}},r.switchTextureType=function(){r.props.changeBrickSize({size:{width:3,height:1}}),r.props.switchTextureType()},r.handleKeyUp=function(){r.setState({isDisabledHandleKey:!1,operation:{type:J}})},r.undoredo=function(e){var t,o=r.props,n=o.history,a=o.addBrick,i=o.removeBrick,s=o.changeBrickColor;if(0!==n[e].length){var l=(t={},Object(c.a)(t,J,function(t){var r=t.brick,o=t.color,n=t.colorPresetName;return"redo"===e?a({brick:r,color:o,colorPresetName:n}):i({brick:r})}),Object(c.a)(t,q,function(t){var r=t.brick,o=t.color,n=t.colorPresetName;return"undo"===e?a({brick:r,color:o,colorPresetName:n}):i({brick:r})}),Object(c.a)(t,W,function(t){var r=t.brickId,o=t.color,n=t.colorPresetName;return s({brickId:r,color:"redo"===e?o.new:o.old,colorPresetName:n})}),t),u=v.a.last(n[e]);v.a.isArray(u)?u.forEach(function(e){l[e.type](e.data)}):l[u.type](u.data),r.props.historySwap({type:e})}},r.makeRandomPainting=function(e){Object.keys(e).length&&(r.state.defaultPainting||r.makePainingForCustomSectorSize(e))},r.makePainingForCustomSectorSize=function(e){var t=r.state,o=t.teilwidth,n=t.teilheight,a=t.customSector;console.log("TCL: makePainingForCustomSectorSize -> teilheight",n),console.log("TCL: makePainingForCustomSectorSize -> teilwidth",o);var i=r.props,c=i.bricks,s=i.sector,l=re(c,s),u=$e(l,s,o,n),p=function e(t){if(t.length<2)return[];var r=Object(F.a)(t),o=r[0],n=r.slice(1),a=v.a.find(n,function(e){return function(e,t){var r=[1===e.size.width,e.position.left===t.position.left].every(function(e){return e}),o=[1===e.size.height,e.position.top===t.position.top].every(function(e){return e});return r||o}(o,e)});if(!a&&0===n.length)return[];if(!a&&n.length>0)return e(n);var i=v.a.without(n,a);return 0===i.length?[o,a]:v.a.flatten([[o,a]].concat(Object(m.a)(e(i))))}(Object.values(u).filter(function(e){var t=e.position,r=t.left,o=t.top,n=e.size;return ae({left:r+a.left,top:o+a.top},n,a)})),d=v.a.keyBy(p,"id"),h=se(v.a.chunk(p,2).concat(Object.values(u).filter(function(e){return!(e.id in d)}).map(function(e){return[e]})),e),b={};Object.keys(h).forEach(function(e){var t=h[e],r="".concat(e,"-").concat("1");b[r]={colorPresetName:"1",brickId:e,color:t}}),r.setState({customSectorBricks:u,customSectorBrickColors:b,operation:{type:J}}),r.props.historyRemove(),r.props.resetBrickColors()},r.handleTileSize=function(e,t){var o;if(console.log(e,t),r.state.defaultPainting)r.setState({teilwidth:1,teilheight:1,customSectorBricks:[],customSector:Object(f.a)({},r.props.sector)});else{var n=r.state,a=n.customSector,i=n.tileStep,s="width"===e?t:r.state.teilwidth,l="height"===e?t:r.state.teilheight,u=Math.ceil(480/(s*r.props.sector.width*i));console.log(r.props.sector.width*r.state.tileStep*r.state.teilwidth);var p=Math.ceil(539/(l*r.props.sector.height*i));console.log("TCL: handleTileSize -> tileStep",i),r.setState((o={},Object(c.a)(o,"teil".concat(e),t),Object(c.a)(o,"customSector",Object(f.a)({},a,Object(c.a)({},e,r.props.sector[e]*t))),Object(c.a)(o,"gridSize",{width:u,height:p}),Object(c.a)(o,"customSectorBricks",[]),o))}},r.state={operation:{type:J},tileStep:15,color:Object.values(Ze)[0],isDisabledHandleKey:!1,teilwidth:1,teilheight:1,defaultPainting:!0,customSectorBricks:[],customSector:r.props.sector,customSectorBrickColors:{},gridSize:{width:Math.ceil(480/(15*r.props.sector.width)),height:Math.ceil(539/(15*r.props.sector.height))},showGrid:!1},r.setSectorSize=r.setSectorSize.bind(Object(Le.a)(Object(Le.a)(r))),r.setBrickOperation=r.setBrickOperation.bind(Object(Le.a)(Object(Le.a)(r))),r.setPaintOperation=r.setPaintOperation.bind(Object(Le.a)(Object(Le.a)(r))),r.setRemoveBrickOperation=r.setRemoveBrickOperation.bind(Object(Le.a)(Object(Le.a)(r))),r.changeColor=r.changeColor.bind(Object(Le.a)(Object(Le.a)(r))),r.makeRandomPainting=r.makeRandomPainting.bind(Object(Le.a)(Object(Le.a)(r))),r.save=r.save.bind(Object(Le.a)(Object(Le.a)(r))),r}return Object(xe.a)(t,e),Object(Re.a)(t,[{key:"componentDidMount",value:function(){var e=this;setInterval(Object(i.a)(a.a.mark(function t(){var r,o,n;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.state.defaultPainting){t.next=9;break}return t.t0=e,t.next=4,oe(e.props.sector.width,e.props.sector.height);case 4:t.t1=t.sent,t.t2={preview:t.t1},t.t0.setState.call(t.t0,t.t2),t.next=16;break;case 9:return r=e.state.customSector,o=r.width,n=r.height,t.t3=e,t.next=13,oe(o,n);case 13:t.t4=t.sent,t.t5={preview:t.t4},t.t3.setState.call(t.t3,t.t5);case 16:case"end":return t.stop()}},t,this)})),1e3)}},{key:"getInsideBricks",value:function(){var e=this.props,t=e.bricks,r=e.sector;return t.filter(function(e){return!ae(e.position,e.size,r)})}},{key:"setOperation",value:function(e){(e.type!==W||this.state.defaultPainting)&&this.setState({operation:e})}},{key:"updatePreview",value:function(){var e=Object(i.a)(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=this,e.next=3,oe(this.props.sector.width,this.props.sector.height);case 3:e.t1=e.sent,e.t2={preview:e.t1},e.t0.setState.call(e.t0,e.t2);case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"save",value:function(){var e=Object(i.a)(a.a.mark(function e(){var t;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X.a.toPng(document.querySelector(".sectorItem"),{width:15*(this.state.defaultPainting?this.props.sector.width:this.state.customSector.width),height:15*(this.state.defaultPainting?this.props.sector.height:this.state.customSector.height)});case 2:t=e.sent,document.querySelector("#preview").src=t,document.body.background=this.state.fillBackground?t:"none",window.vasya&&window.vasya.save(t);case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"textureTypePanel",value:function(){return l.a.createElement("div",{className:"textureTypePanel"},l.a.createElement("p",{className:"textureTypePanel-item"},"\u0422\u0438\u043f \u0442\u0435\u043a\u0441\u0442\u0443\u0440\u044b:"),l.a.createElement("p",{className:"textureTypePanel-item"},"\u041a\u0438\u0440\u043f\u0438\u0447",l.a.createElement("input",{className:"input",type:"radio",name:"textureType",checked:"brick"===this.props.textureType,onChange:this.switchTextureType})),l.a.createElement("p",{className:"textureTypePanel-item"},"\u041f\u043b\u0438\u0442\u043a\u0430",l.a.createElement("input",{className:"input",type:"radio",name:"textureType",checked:"tile"===this.props.textureType,onChange:this.switchTextureType})))}},{key:"renderGrid",value:function(){for(var e=this,t=[],r=0;r<this.state.gridSize.height;r+=1)t.push(r);for(var o=[],n=0;n<this.state.gridSize.width;n+=1)o.push(n);return t.map(function(t,r){return o.map(function(t,o){return l.a.createElement("div",{key:"".concat(r,":").concat(o),style:{width:e.props.sector.width*e.state.tileStep*e.state.teilwidth,height:e.props.sector.height*e.state.tileStep*e.state.teilheight,border:"1px solid red",boxSizing:"border-box",position:"absolute",left:o*e.props.sector.width*e.state.tileStep*e.state.teilwidth,top:r*e.props.sector.height*e.state.tileStep*e.state.teilheight}},"")})})}},{key:"render",value:function(){var e=this;return l.a.createElement("div",{style:st},l.a.createElement(_e.a,{handleKeys:it,isDisabled:this.state.isDisabledHandleKey,handleEventType:"keydown",onKeyEvent:this.handleKeyDown,handleFocusableElements:!0}),l.a.createElement(_e.a,{handleKeys:it,handleEventType:"keyup",onKeyEvent:this.handleKeyUp,handleFocusableElements:!0}),l.a.createElement("div",{style:lt},l.a.createElement(et,{setSectorSize:this.setSectorSize,confirmChangeSectorSize:this.confirmChangeSectorSize,sector:this.props.sector}),l.a.createElement(qe,{colors:Ze,color:this.state.color,changeColor:this.changeColor}),this.textureTypePanel(),l.a.createElement(ze.a,null,l.a.createElement(Fe,{color:this.state.color,currentOperation:this.state.operation,step:20,setBrickOperation:this.setBrickOperation,setRemoveBrickOperation:this.setRemoveBrickOperation,setPaintOperation:this.setPaintOperation,disablePaintButton:!this.state.defaultPainting})),l.a.createElement(at,{makeRandomPainting:this.makeRandomPainting,onSaveRandomPalette:this.onSaveRandomPalette,removeRandomPalette:this.removeRandomPalette,bricks:this.props.bricks,onSave:this.save,colors:Ze,color:this.state.color,randomPalettes:this.props.randomPalettes,importPaintingPalettes:this.importPaintingPalettes,exportPaintingPalettes:this.exportPaintingPalettes,defaultPainting:this.state.defaultPainting})),l.a.createElement("div",{style:{width:495,height:"100%",padding:"6px 6px 6px",overflow:"hidden"}},l.a.createElement("div",{className:"tile-options-panel"},l.a.createElement("div",null,l.a.createElement(We,{style:{position:"relative"},value:this.state.teilwidth,min:1,max:6,onChange:function(t){return e.handleTileSize("width",t)}}),l.a.createElement(We,{style:{position:"relative"},value:this.state.teilheight,min:1,max:6,onChange:function(t){return e.handleTileSize("height",t)}})),l.a.createElement("p",{style:{padding:0,display:"block",margin:"0"}},l.a.createElement("input",{style:{marginRight:"5px"},type:"checkbox",name:"paintingType",checked:!this.state.defaultPainting,onChange:function(){return e.setState({defaultPainting:!e.state.defaultPainting,teilwidth:1,customSectorBricks:[],teilheight:1,customSector:Object(f.a)({},e.props.sector),gridSize:{width:Math.ceil(480/(15*e.props.sector.width)),height:Math.ceil(539/(15*e.props.sector.height))}})}}),"\u041c\u0435\u043b\u0430\u043d\u0436"),l.a.createElement("p",{style:{padding:0,display:"block",margin:"0"}},l.a.createElement("input",{style:{marginRight:"5px"},type:"checkbox",name:"paintingType",checked:this.state.showGrid,onChange:function(){return e.setState({showGrid:!e.state.showGrid})}}),"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0441\u0435\u0442\u043a\u0443")),l.a.createElement("div",{style:{width:"480px",height:"539px",overflow:"hidden",backgroundColor:"#7f7f7f",position:"relative",backgroundImage:"url('".concat(this.state.preview,"')")}},this.state.showGrid?this.renderGrid():null)),l.a.createElement("div",{style:{position:"absolute",left:-1e3}},this.state.defaultPainting?l.a.createElement(Xe,{bricks:re(this.props.bricks,this.props.sector),sector:this.props.sector,bricksColors:this.props.bricksColors,width:this.props.sector.width,step:this.state.tileStep,colorPresetName:"1",textureType:this.props.textureType}):l.a.createElement(Xe,{bricks:this.state.customSectorBricks,sector:this.state.customSector,bricksColors:this.state.customSectorBrickColors,width:this.state.customSector.width,step:this.state.tileStep,colorPresetName:"1",textureType:this.props.textureType}),l.a.createElement("img",{id:"preview",alt:"preview",src:"https://via.placeholder.com/1"})))}}]),t}(s.Component),pt=Object(Ee.b)(function(e){return{bricks:e.bricks,templateSize:e.templateSize,sector:e.sector,bricksColors:e.bricksColors,history:e.history,textureType:e.textureType,randomPalettes:e.randomPaletts}},o)(ut),dt=(r(73),function(e){var t=e.store;return l.a.createElement(Ee.a,{store:t},l.a.createElement(pt,null))});var ht=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"new";return{id:b()(),name:e,colors:[]}}("\u043f\u0430\u043b\u0438\u0442\u0440\u0430 0"),bt={currentPalette:ht.id,palettes:Object(c.a)({},ht.id,ht)};!function(){var e=Object(i.a)(a.a.mark(function e(){var t,r,o,n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.CefSharp){e.next=9;break}return e.next=3,window.CefSharp.BindObjectAsync("vasya");case 3:r=window.vasya.loadString("palette"),o=r?JSON.parse(r):bt,(t=Object(d.c)(we({colorPaletteState:o}),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__())).subscribe(function(){n!==(n=t.getState().colorPalette)&&window.vasya.saveString("palette",JSON.stringify(n))}),e.next=10;break;case 9:t=Object(d.c)(we({colorPaletteState:bt}),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());case 10:p.a.render(l.a.createElement(dt,{store:t}),document.getElementById("root"));case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()(),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[44,2,1]]]);
//# sourceMappingURL=main.6d3bf015.chunk.js.map