(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{29:function(e){e.exports={"NCS S 0500 - N (\u0431\u0435\u043b\u044b\u0439)":{code:"NCS S 0500 - N (\u0431\u0435\u043b\u044b\u0439)",rgb:"250,250,250"},"NCS S 1030-B10G (\u0441\u0432. \u0433\u043e\u043b.)":{code:"NCS S 1030-B10G (\u0441\u0432. \u0433\u043e\u043b.)",rgb:"157,223,233"},"NCS S 2002-B50G (\u0441\u0432. \u0441\u0435\u0440.)":{code:"NCS S 2002-B50G (\u0441\u0432. \u0441\u0435\u0440.)",rgb:"182,191,189"},"NCS S 2060-G70Y (\u043e\u043b\u0438\u0432.)":{code:"NCS S 2060-G70Y (\u043e\u043b\u0438\u0432.)",rgb:"174,180,0"},"NCS S 1080-Y (\u0437\u043e\u043b\u043e\u0442.)":{code:"NCS S 1080-Y (\u0437\u043e\u043b\u043e\u0442.)",rgb:"236,188,0"},"NCS S 5040-B70G (\u0438\u0437\u0443\u043c\u0440.)":{code:"NCS S 5040-B70G (\u0438\u0437\u0443\u043c\u0440.)",rgb:"0,83,65"},"NCS S 8010-Y90R (\u0442. \u041a\u043e\u0440.)":{code:"NCS S 8010-Y90R (\u0442. \u041a\u043e\u0440.)",rgb:"41,18,20"},"NCS S 2070-Y90R":{code:"NCS S 2070-Y90R",rgb:"181,31,39"},"NCS S 4050-G10Y":{code:"NCS S 4050-G10Y",rgb:"0,100,53"},"RAL 3001":{code:"RAL 3001",rgb:"152,35,35"},"RAL 6018":{code:"RAL 6018",rgb:"89,154,57"},"NCS S 0575-G90Y":{code:"NCS S 0575-G90Y",rgb:"250,222,0"},"NCS S 1080-Y20R":{code:"NCS S 1080-Y20R",rgb:"244,153,0"},"NCS S 1002-B50G":{code:"NCS S 1002-B50G",rgb:"231,235,230"},"NCS S 5502-B":{code:"NCS S 5502-B",rgb:"91,95,97"},"NCS S 1040-R90B":{code:"NCS S 1040-R90B",rgb:"136,195,226"},"NCS S 1080-Y50R":{code:"NCS S 1080-Y50R",rgb:"235,97,0"},"NCS S 1060-G70Y":{code:"NCS S 1060-G70Y",rgb:"207,212,45"},"NCS S 1075-G60Y":{code:"NCS S 1075-G60Y",rgb:"194,213,0"},"NCS S 2070-G30Y RAL 6038":{code:"NCS S 2070-G30Y RAL 6038",rgb:"62,164,0"},"NCS S 0585-Y70R":{code:"NCS S 0585-Y70R",rgb:"224,47,7"},"NCS S 2070-Y70R":{code:"NCS S 2070-Y70R",rgb:"205,42,3"},"NCS S 1502-B50G":{code:"NCS S 1502-B50G",rgb:"203,211,208"},"RAL 6024":{code:"RAL 6024",rgb:"0,132,80"},"NCS S 7010-Y30R":{code:"NCS S 7010-Y30R",rgb:"66,51,34"},"RAL 7011 NCS S 7502-B":{code:"RAL 7011 NCS S 7502-B",rgb:"41,45,47"},"NCS S 7005-Y80R":{code:"NCS S 7005-Y80R",rgb:"57,50,47"},"NCS S 2030-R10B":{code:"NCS S 2030-R10B",rgb:"215,137,150"},"NCS S 2060-R10B":{code:"NCS S 2060-R10B",rgb:"184,39,80"},"NCS S 3502-B":{code:"NCS S 3502-B",rgb:"141,145,148"},"NCS S 0560-Y60R":{code:"NCS S 0560-Y60R",rgb:"247,127,68"},"NCS S 6502-B":{code:"NCS S 6502-B",rgb:"67,71,73"},"NCS S 0570-G80Y":{code:"NCS S 0570-G80Y",rgb:"243,226,40"},"NCS S 1075-G80Y":{code:"NCS S 1075-G80Y",rgb:"215,214,0"},"NCS S 1080-Y70R":{code:"NCS S 1080-Y70R",rgb:"226,52,3"},"NCS S 1070-G40Y":{code:"NCS S 1070-G40Y",rgb:"159,206,18"},"NCS S 0520-B10G":{code:"NCS S 0520-B10G",rgb:"211,242,247"},"NCS S 3030-B10G":{code:"NCS S 3030-B10G",rgb:"100,174,186"},"NCS S 4030-B10G":{code:"NCS S 4030-B10G",rgb:"59,114,126"},"NCS S 0540-G60Y":{code:"NCS S 0540-G60Y",rgb:"235,241,135"},"NCS S 0540-G30Y":{code:"NCS S 0540-G30Y",rgb:"208,239,159"},"NCS S 0560-G30Y":{code:"NCS S 0560-G30Y",rgb:"176,222,106"},"NCS S 1060-Y20R":{code:"NCS S 1060-Y20R",rgb:"248,167,34"},"NCS S 7020-R10B":{code:"NCS S 7020-R10B",rgb:"36,8,14"},"NCS S 4030-Y50R":{code:"NCS S 4030-Y50R",rgb:"177,120,96"},"NCS S 3030-Y40R":{code:"NCS S 3030-Y40R",rgb:"202,135,81"},"NCS S 6020-R10B":{code:"NCS S 6020-R10B",rgb:"92,47,59"},"NCS S 2010-Y60R":{code:"NCS S 2010-Y60R",rgb:"209,176,148"},"NCS S 3010-Y60R":{code:"NCS S 3010-Y60R",rgb:"181,150,132"},"NCS S 5010-Y50R":{code:"NCS S 5010-Y50R",rgb:"116,94,75"},"NCS S 4550-Y70R":{code:"NCS S 4550-Y70R",rgb:"129,34,15"},"NCS S 0907-Y10R":{code:"NCS S 0907-Y10R",rgb:"249,238,203"},"NCS S 2030-Y40R (NCS S 3030-Y40R+20%)":{code:"NCS S 2030-Y40R (NCS S 3030-Y40R+20%)",rgb:"220,152,95"},"NCS S 2020-Y40R (NCS S 3030-Y40R+30%)":{code:"NCS S 2020-Y40R (NCS S 3030-Y40R+30%)",rgb:"213,165,118"},"RAL 7016 - Anthracite grey":{code:"RAL 7016 - Anthracite grey",rgb:"56,62,66"}}},44:function(e,t,r){e.exports=r(73)},51:function(e,t,r){},60:function(e,t,r){},65:function(e,t,r){},67:function(e,t,r){},69:function(e,t,r){},73:function(e,t,r){"use strict";r.r(t);var o={};r.r(o),r.d(o,"addBrick",function(){return C}),r.d(o,"removeBrick",function(){return k}),r.d(o,"changeBrickSize",function(){return N}),r.d(o,"changeBrickColor",function(){return y}),r.d(o,"changeTemplateSize",function(){return j}),r.d(o,"setSectorSize",function(){return E}),r.d(o,"changePresetName",function(){return w}),r.d(o,"setColor",function(){return R}),r.d(o,"changeCurrentPreset",function(){return B}),r.d(o,"historyPush",function(){return P}),r.d(o,"historySwap",function(){return Y}),r.d(o,"historyRemove",function(){return L}),r.d(o,"addColorPalette",function(){return A}),r.d(o,"removeColorPalette",function(){return T}),r.d(o,"addColorToPalette",function(){return G}),r.d(o,"removeColorFromPalette",function(){return z}),r.d(o,"switchPalette",function(){return I});var n=r(6),a=r.n(n),c=r(14),i=r(3),s=r(1),l=r.n(s),u=r(15),p=r.n(u),d=(r(51),r(16)),b=r(18),h=r.n(b);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var S=r(13),f=r(5),v=r(74),m=r(23),g=r.n(m),O=r(75),C=Object(O.a)("ADD_BRICK"),k=Object(O.a)("REMOVE_BRICK"),N=Object(O.a)("CHANGE_BRICK_SIZE"),y=Object(O.a)("CHANGE_BRICK_COLOR"),j=Object(O.a)("CHANGE_TEMPLATE_SIZE"),E=Object(O.a)("SET_SECTOR_SIZE"),w=Object(O.a)("CHANGE_PRESET_NAME"),R=Object(O.a)("SET_COLOR"),B=Object(O.a)("CHANGE_CURRENT_PRESET"),P=Object(O.a)("HISTORY_PUSH"),Y=Object(O.a)("HISTORY_SWAP"),L=Object(O.a)("HISTORY_REMOVE"),A=Object(O.a)("ADD_COLOR_PALETTE"),T=Object(O.a)("REMOVE_COLOR_PALETTE"),G=Object(O.a)("ADD_COLOR_TO_PALETTE"),z=Object(O.a)("REMOVE_COLOR_TO_PALETTE"),I=Object(O.a)("SWITCH_PALETTE");var x,D,K,H=function(e){var t;return console.log("INIT PALETTE",e),Object(v.a)((t={},Object(i.a)(t,A,function(e){var t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"new";return{id:h()(),name:e,colors:[]}}("\u043f\u0430\u043b\u0438\u0442\u0440\u0430 ".concat(Object.keys(e.palettes).length));return Object(f.a)({},e,{currentPalette:t.id,palettes:Object(f.a)({},e.palettes,Object(i.a)({},t.id,t))})}),Object(i.a)(t,I,function(e,t){return Object(f.a)({},e,{currentPalette:t.payload})}),Object(i.a)(t,z,function(e,t){return Object(f.a)({},e,{palettes:Object(f.a)({},e.palettes,Object(i.a)({},e.currentPalette,Object(f.a)({},e.palettes[e.currentPalette],{colors:e.palettes[e.currentPalette].colors.filter(function(e){return e.code!==t.payload})})))})}),Object(i.a)(t,G,function(e,t){var r=e.palettes[e.currentPalette];return Object(f.a)({},e,{palettes:Object(f.a)({},e.palettes,Object(i.a)({},e.currentPalette,Object(f.a)({},r,{colors:r.colors.concat([t.payload])})))})}),t),e)},M=Object(v.a)((x={},Object(i.a)(x,C,function(e,t){var r=t.payload.brick;return Object(f.a)({},e,Object(i.a)({},r.id,r))}),Object(i.a)(x,k,function(e,t){var r=t.payload.brick;return g.a.omit(e,r.id)}),x),{}),V=Object(v.a)(Object(i.a)({},N,function(e,t){return t.payload.size}),{width:1,height:1}),F=Object(v.a)(Object(i.a)({},j,function(e,t){var r=t.payload.newSize;return Object(f.a)({},e,r)}),{width:10,height:10}),U=Object(v.a)(Object(i.a)({},E,function(e,t){var r=t.payload;return Object(f.a)({},e,r)}),{left:3,top:3,width:4,height:4}),X=Object(v.a)((D={},Object(i.a)(D,C,function(e,t){var r=t.payload,o=r.brick.id,n=r.color,a=r.colorPresetName,c="".concat(o,"-").concat(a);return Object(f.a)({},e,Object(i.a)({},c,{colorPresetName:a,brickId:o,color:n}))}),Object(i.a)(D,y,function(e,t){var r=t.payload,o=r.brickId,n=r.color,a=r.colorPresetName,c="".concat(o,"-").concat(a);return Object(f.a)({},e,Object(i.a)({},c,{colorPresetName:a,brickId:o,color:n}))}),Object(i.a)(D,k,function(e,t){var r=t.payload.brick;return g.a.omitBy(e,function(e){return e.brickId===r.id})}),Object(i.a)(D,w,function(e){return e}),D),{}),W=Object(v.a)((K={},Object(i.a)(K,P,function(e,t){var r=t.payload.operations;return{undo:Object(S.a)(e.undo).concat([r]),redo:[]}}),Object(i.a)(K,Y,function(e,t){var r=t.payload.type,o=e.undo,n=e.redo;return"undo"===r?{undo:o.slice(0,o.length-1),redo:Object(S.a)(n).concat([g.a.last(o)])}:{undo:Object(S.a)(o).concat([g.a.last(n)]),redo:n.slice(0,n.length-1)}}),Object(i.a)(K,L,function(){return{undo:[],redo:[]}}),K),{undo:[],redo:[]}),J=Object(v.a)(Object(i.a)({},w,function(e,t){return t.payload.name}),"1"),q=function(e){var t=e.colorPaletteState;return Object(d.b)({bricks:M,templateSize:F,brickSize:V,sector:U,bricksColors:X,history:W,colorPresetName:J,colorPalette:H(t)})},Z=r(19),$=(r(60),r(7)),Q=r(8),ee=r(10),te=r(9),re=r(11),oe=r(4),ne=r(42),ae=r(32),ce=r.n(ae),ie=r(2),se=r.n(ie),le=r(43),ue=r(40),pe=r(28),de=r.n(pe),be="ADD_BRICK",he="REMOVE_BRICK",Se="CHANGE_COLOR_BRICK",fe=function(e,t,r){return{left:Math.floor(e/r),top:Math.floor(t/r)}},ve=function(e,t){return Object.keys(e).reduce(function(r,o){return Object(f.a)({},r,Object(i.a)({},o,e[o]*t))},{})};function me(e){var t={};return Object.values(e).forEach(function(e){for(var r=0;r<e.size.width;r+=1)for(var o=0;o<e.size.height;o+=1)t["".concat(r+e.position.left,";").concat(o+e.position.top)]=e}),t}function ge(e,t){var r=t.width,o=t.height;return 1===r&&1===o?e:r>o?{top:e.top,left:e.left-Math.round(r/2)}:{left:e.left,top:e.top-Math.round(o/2)}}var Oe=function(e){return e?"rgb(".concat(e,")"):"rgb(214,199,148)"};function Ce(e,t){for(var r=me(e),o={},n=0;n<t.width;n++)for(var a=0;a<t.height;a++){var c=r["".concat(n+t.left,";").concat(a+t.top)];c&&!o[c.id]&&(o[c.id]=c)}var i=Object.values(o),s=Object.values(i).map(function(e){var r=e.position,o=r.left-t.left,n=r.top-t.top;return Object(f.a)({},e,{position:{left:o,top:n}})});return i.length>0?s:[]}function ke(e,t){return Ne.apply(this,arguments)}function Ne(){return(Ne=Object(c.a)(a.a.mark(function e(t,r){var o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,de.a.toPng(document.querySelector(".sectorItem"),{width:15*t,height:15*r});case 2:return o=e.sent,e.abrupt("return",o);case 4:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function ye(e,t,r){var o=e.left-r.left,n=e.top-r.top;return[o<0||n<0,o+t.width>r.width,n+t.height>r.height].some(function(e){return e})}function je(e,t){var r=Object.values(t),o=r.map(function(e){return e.value}).reduce(function(e,t){return e+t}),n=r.map(function(e){return e.value/o}).map(function(t){return Math.round(e.length*t)}),a={};return Object.values(e).forEach(function(e){var t=function(){for(var e=0;e<100;){e+=1;var t=Math.floor(Math.random()*n.length);if(0===n.reduce(function(e,t){return e+t}))return r[t].color;if(n[t]>0)return n[t]-=1,r[t].color}throw new Error("coloring iterations exceeded")}();e.forEach(function(e){a[e.id]=t})}),a}function Ee(e,t,r,o){return e.type===be&&(r===t.width&&o===t.height)}var we=l.a.memo(function(e){var t=e.style,r=e.color,o=e.onClick,n=e.button,a=e.active,c=t.width>t.height?t.height:t.width,i=Oe(r);return l.a.createElement("div",{onClick:o,className:se()("brick",{button:n,active:a}),style:Object(f.a)({},t,{backgroundColor:i,borderWidth:.1*c})})});function Re(e){switch(e.type){case"CHANGE_COLOR_BRICK":return"crosshair";case"REMOVE_BRICK":case"ADD_BRICK":default:return"default"}}var Be={display:"grid",gridTemplateColumns:"26px auto",gridTemplateRows:"26px auto",justifyItems:"left",alignItems:"left",gridTemplateAreas:'"top-tool top-tool" "left-tool editor"'},Pe={gridArea:"top-tool",display:"block",width:"100%",height:"100%"},Ye=function(e){function t(e){var r;return Object($.a)(this,t),(r=Object(ee.a)(this,Object(te.a)(t).call(this,e))).cursorPosition=function(){var e=r.props,t=e.position,o=t.x,n=t.y,a=e.step,c=fe(o-26,n-26,a);r.setState({cursorPosition:c})},r.keyBoardEvents=function(e){console.log(e.key)},r.addBrick=function(){for(var e={id:h()(),position:ge(r.state.cursorPosition,r.props.brickSize),size:r.props.brickSize},t=r.props,o=t.bricks,n=t.colorPresetName,a=t.color,c=me(o),i=[],s=0;s<e.size.width;s++)for(var l=0;l<e.size.height;l++)if(c["".concat(s+e.position.left,";").concat(l+e.position.top)]){var u=c["".concat(s+e.position.left,";").concat(l+e.position.top)],p=r.props.bricksColors["".concat(u.id,"-").concat(n)]?r.props.bricksColors["".concat(u.id,"-").concat(n)].color:{rgb:"rgb(214,199,148)"};r.props.removeBrick({brick:u}),i.push({type:he,data:{brick:u,color:p,colorPresetName:n}})}r.props.addBrick({brick:e,color:a,colorPresetName:n});var d={type:r.props.currentOperation.type,data:{brick:e,color:a,colorPresetName:n}},b=i.length>0?i.concat([d]):d;r.props.historyPush({operations:b})},r.removeBrick=function(e){var t=r.props,o=t.colorPresetName,n=t.color;if(e){r.props.removeBrick({brick:e});var a={type:r.props.currentOperation.type,data:{brick:e,color:n,colorPresetName:o}};r.props.historyPush({operations:a})}},r.changeBrickColor=function(e){if(e){var t=r.props,o=t.color,n=t.colorPresetName,a=t.bricksColors,c=a["".concat(e.id,"-").concat(n)]?a["".concat(e.id,"-").concat(n)].color:void 0;r.props.changeBrickColor({brickId:e.id,color:o,colorPresetName:n});var i={type:r.props.currentOperation.type,data:{brickId:e.id,color:{old:c,new:o},colorPresetName:n}};r.props.historyPush({operations:i})}},r.handleOperation=function(e){return function(t){t.stopPropagation();var o,n=r.props.currentOperation.type;n&&(o={},Object(i.a)(o,be,r.addBrick),Object(i.a)(o,he,r.removeBrick),Object(i.a)(o,Se,r.changeBrickColor),o)[n](e)}},r.state={cursorPosition:{left:0,top:0}},r}return Object(re.a)(t,e),Object(Q.a)(t,[{key:"renderSector",value:function(){var e=this.props,t=e.step,r=e.sector,o={left:0,top:0,width:r.width*t,height:2},n={left:0,top:r.height*t,width:r.width*t,height:2},a={left:0,top:0,width:2,height:r.height*t},c={left:r.width*t,top:0,width:2,height:r.height*t+2};return l.a.createElement("div",{className:"templateSector",style:Object(f.a)({},ve(r,this.props.step),{width:0,height:0})},l.a.createElement("div",{className:"sectorLine",style:o}),l.a.createElement("div",{className:"sectorLine",style:n}),l.a.createElement("div",{className:"sectorLine",style:a}),l.a.createElement("div",{className:"sectorLine",style:c}))}},{key:"renderBrickPreview",value:function(e){var t=ge(e,this.props.brickSize),r=ve(Object(f.a)({},this.props.brickSize,t),this.props.step);return l.a.createElement(we,{style:r,color:this.props.color.rgb})}},{key:"render",value:function(){var e=this,t=this.props,r=t.isActive,o=t.currentOperation,n=t.step,a=t.bricks,c=t.bricksColors,i=t.colorPresetName;return l.a.createElement("div",{style:Be},l.a.createElement("div",{style:Pe},[1,2,3,4].map(function(t){return l.a.createElement(we,{button:!0,active:Ee(o,e.props.brickSize,t,1),onClick:e.props.setBrickOperation(t,1),key:t,style:{width:20*t,height:20,position:"relative",marginRight:6}})}),l.a.createElement("div",{className:se()("tool-button","paint-button",{buttonActive:o.type===Se}),onClick:this.props.setPaintOperation,style:{backgroundColor:"rgb(".concat(this.props.color.rgb,")"),display:"inline-block",marginLeft:1,top:-1,position:"relative"}})),l.a.createElement("div",{style:{gridArea:"left-tool",width:20,paddingTop:3}},[2,3,4].map(function(t){return l.a.createElement(we,{button:!0,onClick:e.props.setBrickOperation(1,t),active:Ee(o,e.props.brickSize,1,t),key:t,"data-w":1,"data-h":t,style:{width:20,height:20*t,position:"relative",marginBottom:7,marginTop:-4}})}),l.a.createElement("div",{className:se()("tool-button","trash-button",{buttonActive:o.type===he}),onClick:this.props.setRemoveBrickOperation,style:{marginTop:-4}})),l.a.createElement("div",{className:"bricks-grid",onMouseMove:this.cursorPosition,onClick:this.handleOperation(),style:Object(f.a)({},ve({height:11,width:11},n),{cursor:Re(o),gridArea:"editor"})},Object.values(a).map(function(t){var r="".concat(t.id,"-").concat(i),o=c[r]?c[r].color.rgb:null;return l.a.createElement(we,{key:t.id,id:t.id,className:"brick",color:o,style:ve(Object(f.a)({},t.position,t.size),n),onClick:e.handleOperation(t)})}),r&&o.type===be&&this.props.position.x>40&&this.props.position.y>40?this.renderBrickPreview(this.state.cursorPosition):null,this.renderSector()))}}]),t}(s.Component),_e=Object(Z.b)(function(e){return{bricks:e.bricks,templateSize:e.templateSize,brickSize:e.brickSize,sector:e.sector,bricksColors:e.bricksColors,colorPresetName:e.colorPresetName}},o)(Ye);function Le(e,t,r){var o=e["".concat(t,"-").concat(r)];return o?o.color.rgb:null}function Ae(e){var t=e.bricks,r=e.sector,o=e.bricksColors,n=e.width,a=e.step,c=e.colorPresetName,i=new Array(1).fill(null).map(function(e,n){return l.a.createElement("div",{key:n,className:"sectorItem",style:Object(f.a)({},ve({width:r.width,height:r.height},a))},t.map(function(e){var t=e.position,r=e.size,n=e.id;return l.a.createElement(we,{key:n,className:"brick",color:Le(o,n,c),style:ve(Object(f.a)({},t,r),a)})}))});return l.a.createElement("div",{style:{gridTemplateColumns:new Array(1).fill(null).map(function(){return"".concat(a*n,"px")}).join(" ")},className:"grid-area-preview"},i)}r(65);var Te=function(e){function t(){var e,r;Object($.a)(this,t);for(var o=arguments.length,n=new Array(o),a=0;a<o;a++)n[a]=arguments[a];return(r=Object(ee.a)(this,(e=Object(te.a)(t)).call.apply(e,[this].concat(n)))).state={dropdownOpen:!1},r.toggle=function(){r.setState(function(e){return{dropdownOpen:!e.dropdownOpen}})},r.setColor=function(e){return function(){r.props.setNewColor(e)}},r.removeColor=function(e){return function(t){t.preventDefault(),r.props.removeColor(e)}},r}return Object(re.a)(t,e),Object(Q.a)(t,[{key:"render",value:function(){var e=this,t=this.props.colorList;return l.a.createElement("div",{className:"color-palette"},Object.values(t).map(function(t){return l.a.createElement("div",{className:"color-palette-item",key:t.code,style:{backgroundColor:Oe(t.rgb)},onClick:e.setColor(t),title:t.code,onContextMenu:e.removeColor(t.code)})}))}}]),t}(s.Component),Ge=function(e){function t(){var e,r;Object($.a)(this,t);for(var o=arguments.length,n=new Array(o),a=0;a<o;a++)n[a]=arguments[a];return(r=Object(ee.a)(this,(e=Object(te.a)(t)).call.apply(e,[this].concat(n)))).state={colorList:[]},r}return Object(re.a)(t,e),Object(Q.a)(t,[{key:"changeColor",value:function(e){var t=this.props.colors[e];this.props.changeColor(t);var r=this.state.colorList;if(!r.some(function(t){return t.code===e})){var o=r.length>5?r.slice(1).concat([t]):Object(S.a)(r).concat([t]);this.setState({colorList:o})}}},{key:"render",value:function(){var e=this;return l.a.createElement("div",{className:"color-list"},l.a.createElement("select",{onChange:function(t){return e.changeColor(t.target.value)},style:{backgroundColor:Oe(this.props.color.rgb),fontSize:"12px",margin:"8px 0 8px"},value:this.props.color.code},Object.values(this.props.colors).map(function(e){var t=e.code,r=e.rgb;return l.a.createElement("option",{style:{backgroundColor:Oe(r)},key:t,value:t},t)})),l.a.createElement(Te,{color:this.state.currentColor,setNewColor:this.props.changeColor,colorList:this.state.colorList,setColorList:this.setColorList,removeColor:this.removeColor}))}}]),t}(s.Component),ze=r(29),Ie=r(21);r(67);var xe=function(e){return l.a.createElement("div",{style:e.style,className:"number-input"},l.a.createElement("div",{className:"ctl",onClick:function(){return function(e){e.onChange&&e.onChange instanceof Function&&(e.value<=e.min||e.onChange(e.value-1))}(e)}},"-"),l.a.createElement("div",{className:"val"},e.value),l.a.createElement("div",{className:"ctl",onClick:function(){return function(e){e.onChange&&e.onChange instanceof Function&&(e.value>=e.max||e.onChange(e.value+1))}(e)}},"+"))},De=function(e){function t(e){var r;return Object($.a)(this,t),(r=Object(ee.a)(this,Object(te.a)(t).call(this,e))).handleSector=function(e,t){var o=Object(i.a)({},e,Number(t));r.props.setSectorSize(o)},r.toggle=r.toggle.bind(Object(oe.a)(Object(oe.a)(r))),r.state={popoverOpen:!1},r}return Object(re.a)(t,e),Object(Q.a)(t,[{key:"toggle",value:function(){var e=this.state.popoverOpen;this.setState({popoverOpen:!e})}},{key:"render",value:function(){var e=this;return l.a.createElement("div",null,l.a.createElement("div",{className:"grid-sector-options-panel"},l.a.createElement("span",{style:{float:"left",fontSize:12,marginLeft:12,position:"relative",top:6}},"\u0420\u0430\u0437\u043c\u0435\u0440 \u0442\u0435\u043a\u0441\u0442\u0443\u0440\u044b"),l.a.createElement(xe,{style:{position:"relative",top:4},value:this.props.sector.width,min:2,max:11,onChange:function(t){return e.handleSector("width",t)}}),l.a.createElement(xe,{style:{position:"relative",top:4},value:this.props.sector.height,min:2,max:11,onChange:function(t){return e.handleSector("height",t)}})),l.a.createElement("div",{className:"tool-button",style:{backgroundColor:"gray",textAlign:"center",width:24,height:24,borderRadius:100,position:"relative",top:4},id:"Popover1",onClick:this.toggle,color:"link"},"?"),l.a.createElement(Ie.b,{placement:"bottom",isOpen:this.state.popoverOpen,target:"Popover1",toggle:this.toggle},l.a.createElement(Ie.d,null,"\u041f\u043e\u043c\u043e\u0449\u044c"),l.a.createElement(Ie.c,null,l.a.createElement("div",null,"\u0414\u043b\u044f \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0446\u0432\u0435\u0442\u0430 \u0432 \u043f\u0430\u043b\u0438\u0442\u0440\u0443 \u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0435\u0433\u043e \u0438\u0437 \u0432\u044b\u043f\u0430\u0434\u0430\u044e\u0449\u0435\u0433\u043e \u0441\u043f\u0438\u0441\u043a\u0430. \u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0438\u0437 \u043f\u0430\u043b\u0438\u0442\u0440\u044b \u043f\u0440\u0430\u0432\u043e\u0439 \u043a\u043b\u0430\u0432\u0438\u0448\u0435\u0439 \u043c\u044b\u0448\u0438.",l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement("b",null,'\u0437\u0430\u0436\u0430\u0442\u044b\u0439 "alt" - \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0446\u0432\u0435\u0442 \u043a\u0438\u0440\u043f\u0438\u0447\u0430')),l.a.createElement("li",null,l.a.createElement("b",null,'\u0437\u0430\u0436\u0430\u0442\u044b\u0439 "shift" - \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043a\u0438\u0440\u043f\u0438\u0447')),l.a.createElement("li",null,l.a.createElement("b",null,'"ctrl+z" - \u043e\u0442\u043c\u0435\u043d\u0438\u0442\u044c \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435')),l.a.createElement("li",null,l.a.createElement("b",null,'"ctrl+y" - \u0432\u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435')),l.a.createElement("li",null,l.a.createElement("b",null,'"up, down, left, right" - \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u0441\u0435\u043a\u0442\u043e\u0440\u0430')),l.a.createElement("li",null,l.a.createElement("b",null,'"+" - \u0443\u0432\u0435\u043b\u0438\u0447\u0438\u0442\u044c \u0440\u0430\u0437\u043c\u0435\u0440 \u0441\u0435\u043a\u0442\u043e\u0440\u0430')),l.a.createElement("li",null,l.a.createElement("b",null,'"-" - \u0443\u043c\u0435\u043d\u044c\u0448\u0438\u0442\u044c \u0440\u0430\u0437\u043c\u0435\u0440 \u0441\u0435\u043a\u0442\u043e\u0440\u0430')))))))}}]),t}(l.a.Component),Ke=(r(69),function(e){function t(e){var r;return Object($.a)(this,t),(r=Object(ee.a)(this,Object(te.a)(t).call(this,e))).state={colorList:[]},r.addNewColor=function(){var e=r.props.color,t=r.state.colorList;r.setState({colorList:Object(S.a)(t).concat([{color:e,value:1}])})},r.changeColorValue=r.changeColorValue.bind(Object(oe.a)(Object(oe.a)(r))),r.changeColor=r.changeColor.bind(Object(oe.a)(Object(oe.a)(r))),r}return Object(re.a)(t,e),Object(Q.a)(t,[{key:"changeColorValue",value:function(e,t){var r=this.state.colorList[e];this.setState(function(o){var n=o.colorList.slice(0);return n.splice(e,1,Object(f.a)({},r,{value:t})),{colorList:n}})}},{key:"changeColor",value:function(e,t){var r=this,o=this.state.colorList[e];this.setState(function(n){var a=n.colorList.slice(0);return a.splice(e,1,{color:r.props.colors[t],value:o.value}),{colorList:a}})}},{key:"deleteColor",value:function(e){this.setState(function(t){var r=t.colorList.slice(0);return r.splice(e,1),{colorList:r}})}},{key:"renderColorList",value:function(){var e=this,t=this.state.colorList,r=t.map(function(e){return e.value}).reduce(function(e,t){return e+t});return l.a.createElement(l.a.Fragment,null,t.map(function(t,o){return l.a.createElement("div",{key:o,className:"color-preview"},l.a.createElement("div",{className:"delete-random-color",onClick:function(){return e.deleteColor(o)}}),l.a.createElement("select",{onChange:function(t){return e.changeColor(o,t.target.value)},style:{backgroundColor:Oe(t.color.rgb)}},Object.values(e.props.colors).map(function(e){return l.a.createElement("option",{value:e.code,key:e.code,style:{backgroundColor:Oe(e.rgb)}},e.code)})),l.a.createElement("input",{type:"number",value:t.value,min:"0",onChange:function(t){return e.changeColorValue(o,Number(t.target.value))}}),l.a.createElement("span",{className:"percent"},0===(n=t.value)?0:Math.round(n/r*100),"%"));var n}))}},{key:"render",value:function(){var e=this;return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{style:{textAlign:"right",userSelect:"none"}},l.a.createElement("span",{style:{float:"left",fontSize:12,marginLeft:12}},"\u0421\u043b\u0443\u0447\u0430\u0439\u043d\u0430\u044f \u043f\u043e\u043a\u0440\u0430\u0441\u043a\u0430"),l.a.createElement("div",{className:"tool-button random-button",style:{color:"transparent"},onClick:function(){return e.props.makeRandomPainting(e.state.colorList)},size:"sm"},"i"),l.a.createElement("div",{className:"tool-button",style:{marginLeft:6,textAlign:"center"},onClick:this.addNewColor,size:"sm"},"+")),l.a.createElement("div",{style:{height:150,overflowY:"scroll"}},this.state.colorList.length>0?this.renderColorList():null),l.a.createElement(Ie.a,{onClick:this.props.onSave,size:"sm",block:!0},"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"))}}]),t}(s.Component)),He=["left","up","right","down","alt","shift","ctrl+z","ctrl+y","+","-"],Me={minHeight:454,display:"inline-grid",border:"1px solid gray",gridTemplateColumns:"auto auto",gridTemplateRows:"auto",gridColumnGap:"10px",gridRowGap:"15px",placeItems:"flex-start",gridTemplateAreas:'"editor preview"'},Ve={padding:"6px 0 6px 6px"},Fe=function(e){function t(e){var r;return Object($.a)(this,t),(r=Object(ee.a)(this,Object(te.a)(t).call(this,e))).changeColor=function(e){return r.setState({color:e})},r.setSectorSize=function(e){r.props.setSectorSize(e)},r.undoredo=function(e){var t,o=r.props,n=o.history,a=o.addBrick,c=o.removeBrick,s=o.changeBrickColor;if(0!==n[e].length){var l=(t={},Object(i.a)(t,be,function(t){var r=t.brick,o=t.color,n=t.colorPresetName;return"redo"===e?a({brick:r,color:o,colorPresetName:n}):c({brick:r})}),Object(i.a)(t,he,function(t){var r=t.brick,o=t.color,n=t.colorPresetName;return"undo"===e?a({brick:r,color:o,colorPresetName:n}):c({brick:r})}),Object(i.a)(t,Se,function(t){var r=t.brickId,o=t.color,n=t.colorPresetName;return s({brickId:r,color:"redo"===e?o.new:o.old,colorPresetName:n})}),t),u=_.last(n[e]);_.isArray(u)?u.forEach(function(e){l[e.type](e.data)}):l[u.type](u.data),r.props.historySwap({type:e})}},r.handleKeyDown=function(e){var t=r.props,o=t.sector,n=t.setSectorSize,a={alt:Se,shift:he,"ctrl+z":r.undoredo.bind(Object(oe.a)(Object(oe.a)(r)),"undo"),"ctrl+y":r.undoredo.bind(Object(oe.a)(Object(oe.a)(r)),"redo"),left:n.bind(Object(oe.a)(Object(oe.a)(r)),{left:o.left-1}),up:n.bind(Object(oe.a)(Object(oe.a)(r)),{top:o.top-1}),right:n.bind(Object(oe.a)(Object(oe.a)(r)),{left:o.left+1}),down:n.bind(Object(oe.a)(Object(oe.a)(r)),{top:o.top+1}),"+":n.bind(Object(oe.a)(Object(oe.a)(r)),{width:o.width+1,height:o.height+1}),"-":n.bind(Object(oe.a)(Object(oe.a)(r)),{width:o.width-1,height:o.height-1})}[e];_.isFunction(a)?a():r.setState({isDisabledHandleKey:!0,operation:{type:a}})},r.setBrickOperation=function(e,t){return function(){console.log("set operation ADD_BRICK",e,t),r.props.changeBrickSize({size:{width:e,height:t}}),r.setOperation({type:be})}},r.setPaintOperation=function(){return r.setOperation({type:Se})},r.setRemoveBrickOperation=function(){return r.setOperation({type:he})},r.handleKeyUp=function(){r.setState({isDisabledHandleKey:!1,operation:{type:be}})},r.state={operation:{type:be},workareaStep:20,tileStep:15,color:Object.values(ze)[0],isDisabledHandleKey:!1},r.setSectorSize=r.setSectorSize.bind(Object(oe.a)(Object(oe.a)(r))),r.setBrickOperation=r.setBrickOperation.bind(Object(oe.a)(Object(oe.a)(r))),r.setPaintOperation=r.setPaintOperation.bind(Object(oe.a)(Object(oe.a)(r))),r.setRemoveBrickOperation=r.setRemoveBrickOperation.bind(Object(oe.a)(Object(oe.a)(r))),r.changeColor=r.changeColor.bind(Object(oe.a)(Object(oe.a)(r))),r.makeRandomPainting=r.makeRandomPainting.bind(Object(oe.a)(Object(oe.a)(r))),r.save=r.save.bind(Object(oe.a)(Object(oe.a)(r))),r}return Object(re.a)(t,e),Object(Q.a)(t,[{key:"componentDidMount",value:function(){var e=this;setInterval(Object(c.a)(a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=e,t.next=3,ke(e.props.sector.width,e.props.sector.height);case 3:t.t1=t.sent,t.t2={preview:t.t1},t.t0.setState.call(t.t0,t.t2);case 6:case"end":return t.stop()}},t,this)})),1e3)}},{key:"updatePreview",value:function(){var e=Object(c.a)(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=this,e.next=3,ke(this.props.sector.width,this.props.sector.height);case 3:e.t1=e.sent,e.t2={preview:e.t1},e.t0.setState.call(e.t0,e.t2);case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getInsideBricks",value:function(){var e=this.props,t=e.bricks,r=e.sector;return t.filter(function(e){return!ye(e.position,e.size,r)})}},{key:"makeRandomPainting",value:function(e){var t=this;if(Object.keys(e).length){var r=this.props,o=r.bricks,n=r.bricksColors,a=function e(t){if(t.length<2)return[];var r=Object(ue.a)(t),o=r[0],n=r.slice(1),a=n.filter(function(e){return function(e,t){var r=[1===e.size.width,e.position.left===t.position.left].every(function(e){return e}),o=[1===e.size.height,e.position.top===t.position.top].every(function(e){return e});return r||o}(o,e)}),c=Object(le.a)(a,1)[0];if(!c&&0===n.length)return[];if(!c&&n.length>0)return e(n);var i=_.without(n,c);return 0===i.length?[o,c]:_.flatten([[o,c]].concat(Object(S.a)(e(i))))}(Object.values(o).filter(function(e){return ye(e.position,e.size,t.props.sector)})),c=_.keyBy(a,"id"),i=je(_.chunk(a,2).concat(Object.values(o).filter(function(e){return!(e.id in c)}).map(function(e){return[e]})),e),s=[];Object.keys(i).forEach(function(e){var r=i[e],o=n["".concat(e,"-").concat("1")]?n["".concat(e,"-").concat("1")].color:void 0;t.props.changeBrickColor({brickId:e,color:r,colorPresetName:"1"}),s.push({type:s.CHANGE_COLOR_BRICK,data:{brickId:e,color:{old:o,new:r},colorPresetName:"1"}})}),this.props.historyPush({operations:s})}}},{key:"setOperation",value:function(e){this.setState({operation:e})}},{key:"save",value:function(){var e=Object(c.a)(a.a.mark(function e(){var t;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,de.a.toPng(document.querySelector(".sectorItem"),{width:15*this.props.sector.width,height:15*this.props.sector.height});case 2:t=e.sent,document.querySelector("#preview").src=t,document.body.background=this.state.fillBackground?t:"none",window.vasya&&window.vasya.save(t);case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return l.a.createElement("div",{style:Me},l.a.createElement(ce.a,{handleKeys:He,isDisabled:this.state.isDisabledHandleKey,handleEventType:"keydown",onKeyEvent:this.handleKeyDown,handleFocusableElements:!0}),l.a.createElement(ce.a,{handleKeys:He,handleEventType:"keyup",onKeyEvent:this.handleKeyUp,handleFocusableElements:!0}),l.a.createElement("div",{style:Ve},l.a.createElement(De,{setSectorSize:this.setSectorSize,sector:this.props.sector}),l.a.createElement(Ge,{colors:ze,color:this.state.color,changeColor:this.changeColor}),l.a.createElement(ne.a,null,l.a.createElement(_e,{color:this.state.color,currentOperation:this.state.operation,step:20,updateBrickSector:this.updateBrickSector,addToHistory:this.addToHistory,setBrickOperation:this.setBrickOperation,setRemoveBrickOperation:this.setRemoveBrickOperation,setPaintOperation:this.setPaintOperation})),l.a.createElement(Ke,{makeRandomPainting:this.makeRandomPainting,bricks:this.props.bricks,onSave:this.save,colors:ze,color:this.state.color})),l.a.createElement("div",{style:{width:495,height:"100%",padding:"6px 6px 6px"}},l.a.createElement("div",{style:{width:"100%",height:"100%",overflow:"hidden",backgroundColor:"#7f7f7f",position:"relative",backgroundImage:"url('".concat(this.state.preview,"')")}})),l.a.createElement("div",{style:{position:"absolute",left:-1e3}},l.a.createElement(Ae,{bricks:Ce(this.props.bricks,this.props.sector),sector:this.props.sector,bricksColors:this.props.bricksColors,width:this.props.sector.width,step:this.state.tileStep,colorPresetName:"1"}),l.a.createElement("img",{id:"preview",alt:"preview",src:"https://via.placeholder.com/1"})))}}]),t}(s.Component),Ue=Object(Z.b)(function(e){return{bricks:e.bricks,templateSize:e.templateSize,sector:e.sector,bricksColors:e.bricksColors,history:e.history}},o)(Fe),Xe=(r(71),function(e){var t=e.store;return l.a.createElement(Z.a,{store:t},l.a.createElement(Ue,null))});var We=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"new";return{id:h()(),name:e,colors:[]}}("\u043f\u0430\u043b\u0438\u0442\u0440\u0430 0"),Je={currentPalette:We.id,palettes:Object(i.a)({},We.id,We)};!function(){var e=Object(c.a)(a.a.mark(function e(){var t,r,o,n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.CefSharp){e.next=9;break}return e.next=3,window.CefSharp.BindObjectAsync("vasya");case 3:r=window.vasya.loadString("palette"),o=r?JSON.parse(r):Je,(t=Object(d.c)(q({colorPaletteState:o}),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__())).subscribe(function(){n!==(n=t.getState().colorPalette)&&window.vasya.saveString("palette",JSON.stringify(n))}),e.next=10;break;case 9:t=Object(d.c)(q({colorPaletteState:Je}),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());case 10:p.a.render(l.a.createElement(Xe,{store:t}),document.getElementById("root"));case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()(),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[44,2,1]]]);
//# sourceMappingURL=main.ea22321f.chunk.js.map